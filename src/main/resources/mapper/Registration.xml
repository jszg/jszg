<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--namespace 非常重要：必须是 Mapper 类的全路径-->
<mapper namespace="com.xtuer.mapper.RegistrationMapper">
    <select id="deleteByRegisterId" resultType="RegistrationForm">
        DELETE
        FROM
            t_registration r
        WHERE
            hv.reg_id = #{registerId}
    </select>
    <insert id="insertRegistration" parameterType="RegistrationForm">
        <selectKey resultType="long" order="BEFORE" keyProperty="regId">
            SELECT s_reg_id.nextval AS regId FROM dual
        </selectKey>
        <![CDATA[
        INSERT INTO t_registration (
            id_no,              cert_no,                    cert_assign,                cb_id,
            org_id,             subject,                    name,                       sex,
            nation,             address,                    birth_place,                cellphone,
            degree,             edu_level,                  email,                      password,
            graduate_school,    temp_school,                gradua_time,                learn_type,
            major,              normal_major,               phone,                      political,
            pth_level,          residence,                  technique_job,              work_units,
            zip_cole,           exam,                       status,                     data_from,
            delete_status,      org_name,                   province_id,                occupation,
            ip,                 city_id,                    enroll_pro_batch_id,        reg_id,
            birthday,           ct_id,                      id_type,                    status_memo
        )
        VALUES (
            #{idNo},            #{certNo},                  #{certAssignDate},          #{certBatchId,jdbcType=INTEGER},
            #{orgId},           #{subjectId},               #{name},                    #{sex},
            #{nation},          #{address},                 #{birthPlace},              #{cellPhone},
            #{degreeId},        #{eduLevelId},              #{email},                   #{password},
            #{graduateSchool},  #{graduateShoolName},       #{graduaTimeDate},          #{learnType},
            #{majorId},         #{normalMajor},             #{phone},                   #{political},
            #{pthevelId},       #{residence},               #{techniqueJobId},          #{workUnits},
            #{zipCode},         #{exam},                    #{status},                  #{dataFrom},
            #{deleteStatus},    #{orgName},                 #{provinceId},              #{occupation},
            #{ip},              #{cityId,jdbcType=INTEGER}, #{enrollProBatchId},        #{regId},
            #{birthdayDate},    #{certType},#{idType},      #{statusMemo}
        )
        ]]>
    </insert>

    <update id="updateEnrollProBatch" parameterType="RegistrationForm">
        UPDATE  t_registration
        SET  enroll_pro_batch_id = #{provinceBatchId}
        where reg_id = #{registerId}
    </update>

</mapper>
